â¡ VidÃ©os et labs avancÃ©s : https://itfit.tech
# Labs PowerShell â€“ WMI, CIM et Invocation de MÃ©thodes  
ğŸ‘‰ Formations IT complÃ¨tes : https://itfit.tech  
ğŸ‘‰ Apprenez PowerShell, Azure, M365, AD, Automatisation : https://itfit.tech  

---

## ğŸ§ª Exercice 1 : Interroger des informations avec WMI

### ğŸ¯ TÃ¢che 1 : Interroger les adresses IP

1. Sur **LON-CL1**, ouvrir *Windows PowerShell* en mode administrateur.  
2. Pour rechercher une classe WMI listant les adresses IP :

```powershell
Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*configuration*' | Sort Name
ğŸ“Œ Remarquez la classe Win32_NetworkAdapterConfiguration.

Pour afficher toutes les interfaces configurÃ©es en IP statique :

powershell
 
Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Where DHCPEnabled -eq $False | Select IPAddress
ğŸ’¡ Astuce : Vous pouvez utiliser Get-Member pour voir les propriÃ©tÃ©s disponibles.

ğŸ¯ TÃ¢che 2 : Interroger la version du systÃ¨me dâ€™exploitation
Trouver une classe WMI contenant les infos OS :

powershell
 
Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*operating*' | Sort Name
ğŸ“Œ Classe identifiÃ©e : Win32_OperatingSystem

Afficher les propriÃ©tÃ©s de la classe :

powershell
 
Get-WmiObject -Class Win32_OperatingSystem | Get-Member
Afficher version + service pack + numÃ©ro de build :

powershell
 
Get-WmiObject -Class Win32_OperatingSystem | Select Version,ServicePackMajorVersion,BuildNumber
ğŸ¯ TÃ¢che 3 : Interroger les informations matÃ©rielles du systÃ¨me
Rechercher une classe systÃ¨me :

powershell
 
Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*system*' | Sort Name
ğŸ“Œ Classe identifiÃ©e : Win32_ComputerSystem

Afficher toutes les propriÃ©tÃ©s :

powershell
 
Get-WmiObject -Class Win32_ComputerSystem | Format-List -Property *
Afficher fabricant + modÃ¨le + RAM :

powershell
 
Get-WmiObject -Class Win32_ComputerSystem | Select Manufacturer,Model,@{n='RAM';e={$PSItem.TotalPhysicalMemory}}
ğŸ¯ TÃ¢che 4 : Interroger les services
Trouver une classe listant les services :

powershell
 
Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*service*' | Sort Name
ğŸ“Œ Classe identifiÃ©e : Win32_Service

Lister toutes les propriÃ©tÃ©s des services :

powershell
 
Get-WmiObject -Class Win32_Service | FL *
Lister les services commenÃ§ant par "S" :

powershell
 
Get-WmiObject -Class Win32_Service -Filter "Name LIKE 'S%'" | Select Name,State,StartName
ğŸ§ª Exercice 2 : Interroger des informations avec CIM
ğŸ‘‰ Formez-vous en PowerShell : https://itfit.tech

ğŸ¯ TÃ¢che 1 : Interroger les comptes utilisateurs
Trouver une classe listant les comptes :

powershell
 
Get-CimClass -ClassName *user*
ğŸ“Œ Classe : Win32_UserAccount

Voir les propriÃ©tÃ©s de la classe :

powershell
 
Get-CimInstance -Class Win32_UserAccount | Get-Member
Afficher les infos des comptes :

powershell
 
Get-CimInstance -Class Win32_UserAccount | Format-Table Caption,Domain,SID,FullName,Name
ğŸ¯ TÃ¢che 2 : Interroger les informations du BIOS
Trouver une classe BIOS :

powershell
 
Get-CimClass -ClassName *bios*
ğŸ“Œ Classe : Win32_BIOS

Afficher les infos BIOS :

powershell
 
Get-CimInstance -Class Win32_BIOS
ğŸ¯ TÃ¢che 3 : Interroger la configuration des cartes rÃ©seau
Sur la machine locale :

powershell
 
Get-CimInstance -Classname Win32_NetworkAdapterConfiguration
Sur LON-DC1 :

powershell
 
Get-CimInstance -Classname Win32_NetworkAdapterConfiguration -ComputerName LON-DC1
ğŸ¯ TÃ¢che 4 : Interroger les groupes utilisateurs
Trouver une classe listant les groupes :

powershell
 
Get-CimClass -ClassName *group*
ğŸ“Œ Classe : Win32_Group

Afficher les groupes de LON-DC1 :

powershell
 
Get-CimInstance -ClassName Win32_Group -ComputerName LON-DC1
ğŸ§ª Exercice 3 : Invocation de mÃ©thodes WMI & CIM
DÃ©couvrez dâ€™autres labs : https://itfit.tech

ğŸ¯ TÃ¢che 1 : RedÃ©marrer un serveur via CIM
powershell
 
Invoke-CimMethod -ClassName Win32_OperatingSystem -ComputerName LON-DC1 -MethodName Reboot
ğŸ“Œ Retour attendu : ReturnValue = 0

ğŸ¯ TÃ¢che 2 : Modifier un service via WMI
Voir les propriÃ©tÃ©s du service WinRM :

powershell
 
Get-Service WinRM | FL *
Changer son mode de dÃ©marrage :

powershell
 
Get-WmiObject -Class Win32_Service -Filter "Name='WinRM'" | Invoke-WmiMethod -Name ChangeStartMode -Argument 'Automatic'
VÃ©rifier :

powershell
 
Get-Service WinRM | FL *
ğŸ” Le service devrait maintenant Ãªtre en Automatic.

ğŸ“š Ressources complÃ©mentaires
â¡ Formations complÃ¨tes PowerShell, Azure, M365 : https://itfit.tech
â¡ VidÃ©os et labs avancÃ©s : https://itfit.tech

