VERSION COMPLÃˆTE POUR GITHUB : LABS WMI, CIM, VARIABLES, TABLEAUX ET HASH TABLES

ðŸ‘‰ Formations IT professionnelles : https://itfit.tech

ðŸ‘‰ PowerShell, Azure, Microsoft 365, Automatisation : https://itfit.tech

# Labs PowerShell â€“ WMI, CIM, Variables, Tableaux et HashTables  
ðŸ‘‰ DÃ©couvrez mes formations IT (PowerShell, Azure, M365) : https://itfit.tech  

---

# ðŸ§ª Exercice 1 : Interroger des informations avec WMI

## ðŸŽ¯ TÃ¢che 1 : Interroger les adresses IP

1. Sur **LAB-WS01**, ouvrir *Windows PowerShell* en administrateur.
2. Rechercher une classe listant la configuration rÃ©seau :

```powershell
Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*configuration*' | Sort Name


Afficher les interfaces configurÃ©es en IP statique :

Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Where DHCPEnabled -eq $False | Select IPAddress

ðŸŽ¯ TÃ¢che 2 : Version du systÃ¨me dâ€™exploitation

Afficher les classes OS :

Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*operating*' | Sort Name


Lister les propriÃ©tÃ©s disponibles :

Get-WmiObject -Class Win32_OperatingSystem | Get-Member


Afficher version, SP et build :

Get-WmiObject -Class Win32_OperatingSystem | Select Version,ServicePackMajorVersion,BuildNumber

ðŸŽ¯ TÃ¢che 3 : Informations matÃ©rielles du systÃ¨me

Trouver les classes matÃ©rielles :

Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*system*' | Sort Name


Afficher toutes les propriÃ©tÃ©s :

Get-WmiObject -Class Win32_ComputerSystem | Format-List -Property *


Afficher fabricant, modÃ¨le et RAM :

Get-WmiObject -Class Win32_ComputerSystem | Select Manufacturer,Model,@{n='RAM';e={$PSItem.TotalPhysicalMemory}}

ðŸŽ¯ TÃ¢che 4 : Informations sur les services

Rechercher les classes services :

Get-WmiObject -Namespace root\cimv2 -List | Where Name -like '*service*' | Sort Name


Afficher toutes les propriÃ©tÃ©s :

Get-WmiObject -Class Win32_Service | FL *


Afficher les services commenÃ§ant par "S" :

Get-WmiObject -Class Win32_Service -Filter "Name LIKE 'S%'" | Select Name,State,StartName

ðŸ§ª Exercice 2 : Interroger des informations avec CIM
ðŸŽ¯ TÃ¢che 1 : Comptes utilisateurs

Trouver les classes utilisateurs :

Get-CimClass -ClassName *user*


Lister les propriÃ©tÃ©s :

Get-CimInstance -Class Win32_UserAccount | Get-Member


Afficher les donnÃ©es utilisateurs :

Get-CimInstance -Class Win32_UserAccount | Format-Table Caption,Domain,SID,FullName,Name

ðŸŽ¯ TÃ¢che 2 : Informations BIOS

Trouver la classe BIOS :

Get-CimClass -ClassName *bios*


Afficher les informations BIOS :

Get-CimInstance -Class Win32_BIOS

ðŸŽ¯ TÃ¢che 3 : Configuration rÃ©seau locale et distante

Afficher localement :

Get-CimInstance -Classname Win32_NetworkAdapterConfiguration


Afficher depuis LAB-DC01 :

Get-CimInstance -Classname Win32_NetworkAdapterConfiguration -ComputerName LAB-DC01

ðŸŽ¯ TÃ¢che 4 : Groupes utilisateurs

Trouver la classe groupes :

Get-CimClass -ClassName *group*


Afficher les groupes sur LAB-DC01 :

Get-CimInstance -ClassName Win32_Group -ComputerName LAB-DC01

ðŸ§ª Exercice 3 : Invocation de mÃ©thodes
ðŸŽ¯ TÃ¢che 1 : Reboot dâ€™une machine avec CIM

RedÃ©marrer LAB-DC01 :

Invoke-CimMethod -ClassName Win32_OperatingSystem -ComputerName LAB-DC01 -MethodName Reboot

ðŸŽ¯ TÃ¢che 2 : Modifier un service avec WMI

Afficher les propriÃ©tÃ©s du service WinRM :

Get-Service WinRM | FL *


Changer le mode de dÃ©marrage :

Get-WmiObject -Class Win32_Service -Filter "Name='WinRM'" | Invoke-WmiMethod -Name ChangeStartMode -Argument 'Automatic'


VÃ©rifier :

Get-Service WinRM | FL *

ðŸ§ª Exercice 4 : Variables, Tableaux et Hash Tables en PowerShell
ðŸŽ¯ TÃ¢che 1 : Variables string
$logPath = "C:\Logs\"
$logPath.GetType()
$logPath | Get-Member

$logFile = "log.txt"
$logPath += $logFile
$logPath

$logPath = $logPath.Replace("C:","D:")
$logPath

ðŸŽ¯ TÃ¢che 2 : DateTime
$today = Get-Date
$today.GetType()
$today | Get-Member

$logFile = "$($today.Year)-$($today.Month)-$($today.Day)-$($today.Hour)-$($today.Minute).txt"

$cutOffDate = $today.AddDays(-30)

Get-ADUser -Properties LastLogonDate -Filter {LastLogonDate -gt $cutOffDate}

ðŸ§ª Exercice 5 : Tableaux (Arrays)
ðŸŽ¯ TÃ¢che 1 : Mettre Ã  jour un dÃ©partement
$mktgUsers = Get-ADUser -Filter {Department -eq "Marketing"} -Properties Department
$mktgUsers.count
$mktgUsers[0]

$mktgUsers | Set-ADUser -Department "Business Development"

$mktgUsers | Format-Table Name,Department

Get-ADUser -Filter {Department -eq "Marketing"}
Get-ADUser -Filter {Department -eq "Business Development"}

ðŸŽ¯ TÃ¢che 2 : ArrayList
[System.Collections.ArrayList]$computers="LAB-SRV11","LAB-SRV22","LAB-DC01"

$computers.IsFixedSize

$computers.Add("LAB-DC02")
$computers.Remove("LAB-SRV22")

$computers

ðŸ§ª Exercice 6 : Hash Tables
$mailList=@{
    "Frank"="Frank@fabriakm.com";
    "Libby"="LHayward@itfit.com";
    "Matej"="MSTaojanov@tailspintoys.com"
}

$mailList
$mailList.Libby

$mailList.Libby="Libby.Hayward@itfit.com"

$mailList.Add("Stela","Stela.Sahiti")
$mailList.Remove("Frank")

$mailList

ðŸ“š Ressources complÃ©mentaires

âž¡ Formations PowerShell, Azure, Microsoft 365 : https://itfit.tech

âž¡ VidÃ©os + labs + support formateur : https://itfit.tech
